Arguments:
Namespace(exp_pool_path='artifacts/exp_pool/exp_pool.pkl', sample_step=None, num_executors=50, job_arrival_cap=200, job_arrival_rate=4e-05, moving_delay=2000.0, warmup_delay=1000.0, render_mode=None, dataset='tpch', plm_type='llama', plm_size='tiny', rank=128, pt_encoder_config=None, state_feature_dim=256, K=20, gamma=1.0, max_exec_num=50, max_stage_num=100, lr=0.0001, weight_decay=0.0001, warmup_steps=2000, num_iters=10, num_steps_per_iter=10000, eval_max_ep_len=6000, eval_per_iter=1, save_checkpoint_per_iter=1, target_return_scale=1.0, which_layer=-1, train=True, test=False, grad_accum_steps=32, seed=666, env_seed=666, scale=1000, resume_dir=None, resume_iter=None, model_dir=None, use_head=3, device='cuda:0', device_out='cuda:0', device_mid=None)
Experience dataset info:
Munch({'max_reward': 0, 'min_reward': -504129.1369907103, 'max_return': 5.793701710089156, 'min_return': 0.0009962767476381065, 'min_timestep': 0, 'max_timestep': 5813, 'min_num_nodes': 1, 'max_num_nodes': 134, 'min_num_dags': 1, 'max_num_dags': 16, 'min_stage_idx': 0, 'max_stage_idx': 47, 'min_job_idx': 0, 'max_job_idx': 15, 'min_num_exec': 0, 'max_num_exec': 49})
==================== Training Iteration #0 ====================
Step 0 - mean train loss  4.211478
Step 100 - mean train loss  3.262507
Step 200 - mean train loss  3.227548
Step 300 - mean train loss  3.239661
Step 400 - mean train loss  3.200425
Step 500 - mean train loss  3.194049
Step 600 - mean train loss  3.206941
Step 700 - mean train loss  3.194740
Step 800 - mean train loss  3.197189
Step 900 - mean train loss  3.199376
Step 1000 - mean train loss  3.194992
Step 1100 - mean train loss  3.183918
Step 1200 - mean train loss  3.184720
Step 1300 - mean train loss  3.181976
Step 1400 - mean train loss  3.174848
Step 1500 - mean train loss  3.177199
Step 1600 - mean train loss  3.168732
Step 1700 - mean train loss  3.169348
Step 1800 - mean train loss  3.158087
Step 1900 - mean train loss  3.157430
Step 2000 - mean train loss  3.154977
Step 2100 - mean train loss  3.151742
Step 2200 - mean train loss  3.154807
Step 2300 - mean train loss  3.156810
Step 2400 - mean train loss  3.152810
Step 2500 - mean train loss  3.151648
Step 2600 - mean train loss  3.145692
Step 2700 - mean train loss  3.144359
Step 2800 - mean train loss  3.145157
Step 2900 - mean train loss  3.144780
Step 3000 - mean train loss  3.142518
Step 3100 - mean train loss  3.141565
Step 3200 - mean train loss  3.138402
Step 3300 - mean train loss  3.139071
Step 3400 - mean train loss  3.137933
Step 3500 - mean train loss  3.135490
Step 3600 - mean train loss  3.136788
Step 3700 - mean train loss  3.136067
Step 3800 - mean train loss  3.136129
Step 3900 - mean train loss  3.133171
Step 4000 - mean train loss  3.132944
Step 4100 - mean train loss  3.128263
Step 4200 - mean train loss  3.127812
Step 4300 - mean train loss  3.127071
Step 4400 - mean train loss  3.126026
Step 4500 - mean train loss  3.125731
Step 4600 - mean train loss  3.122903
Step 4700 - mean train loss  3.121028
Step 4800 - mean train loss  3.119820
Step 4900 - mean train loss  3.118376
Step 5000 - mean train loss  3.114052
Step 5100 - mean train loss  3.111831
Step 5200 - mean train loss  3.110982
Step 5300 - mean train loss  3.109315
Step 5400 - mean train loss  3.107668
Step 5500 - mean train loss  3.106911
Step 5600 - mean train loss  3.103704
Step 5700 - mean train loss  3.104439
Step 5800 - mean train loss  3.101337
Step 5900 - mean train loss  3.100271
Step 6000 - mean train loss  3.098692
Step 6100 - mean train loss  3.098290
Step 6200 - mean train loss  3.097036
Step 6300 - mean train loss  3.096765
Step 6400 - mean train loss  3.095466
Step 6500 - mean train loss  3.094403
Step 6600 - mean train loss  3.093631
Step 6700 - mean train loss  3.091157
Step 6800 - mean train loss  3.088737
Step 6900 - mean train loss  3.086903
Step 7000 - mean train loss  3.084784
Step 7100 - mean train loss  3.084314
Step 7200 - mean train loss  3.082892
Step 7300 - mean train loss  3.081207
Step 7400 - mean train loss  3.080981
Step 7500 - mean train loss  3.078441
Step 7600 - mean train loss  3.076068
Step 7700 - mean train loss  3.075148
Step 7800 - mean train loss  3.074210
Step 7900 - mean train loss  3.071910
Step 8000 - mean train loss  3.070157
Step 8100 - mean train loss  3.068000
Step 8200 - mean train loss  3.066234
Step 8300 - mean train loss  3.064460
Step 8400 - mean train loss  3.063799
Step 8500 - mean train loss  3.062634
Step 8600 - mean train loss  3.061601
Step 8700 - mean train loss  3.060165
Step 8800 - mean train loss  3.059531
Step 8900 - mean train loss  3.058387
Step 9000 - mean train loss  3.057053
Step 9100 - mean train loss  3.056170
Step 9200 - mean train loss  3.055065
Step 9300 - mean train loss  3.053835
Step 9400 - mean train loss  3.052494
Step 9500 - mean train loss  3.052398
Step 9600 - mean train loss  3.051136
Step 9700 - mean train loss  3.050603
Step 9800 - mean train loss  3.050480
Step 9900 - mean train loss  3.049243
>>>>>>>>>> Training Information:
{'time/training': 3748.207840681076,
 'training/train_loss_mean': 3.0478317191243174,
 'training/train_loss_std': 0.5894911016524162}
Checkpoint saved at: artifacts/ft_plms/llama_tiny/artifacts_exp_pool_exp_pool_ss_None/peft_128_K_20_gamma_1.0_sfd_256_exec_50_stage_100_lr_0.0001_wd_0.0001_warm_2000_iters_10_steps_10000_seed_666/early_stop_-1_checkpoint/0
==================== Training Iteration #1 ====================
Step 0 - mean train loss  2.549870
Step 100 - mean train loss  2.976574
Step 200 - mean train loss  3.044446
Step 300 - mean train loss  2.986282
Step 400 - mean train loss  2.956468
Step 500 - mean train loss  2.936713
Step 600 - mean train loss  2.913606
Step 700 - mean train loss  2.916508
Step 800 - mean train loss  2.910180
Step 900 - mean train loss  2.909297
Step 1000 - mean train loss  2.902962
Step 1100 - mean train loss  2.895979
Step 1200 - mean train loss  2.900832
Step 1300 - mean train loss  2.896788
Step 1400 - mean train loss  2.901277
Step 1500 - mean train loss  2.887766
Step 1600 - mean train loss  2.883366
Step 1700 - mean train loss  2.885970
Step 1800 - mean train loss  2.889770
Step 1900 - mean train loss  2.892848
Step 2000 - mean train loss  2.894347
Step 2100 - mean train loss  2.891687
Step 2200 - mean train loss  2.899454
Step 2300 - mean train loss  2.897111
Step 2400 - mean train loss  2.903472
Step 2500 - mean train loss  2.902604
Step 2600 - mean train loss  2.903502
Step 2700 - mean train loss  2.897938
Step 2800 - mean train loss  2.901240
Step 2900 - mean train loss  2.904126
Step 3000 - mean train loss  2.904133
Step 3100 - mean train loss  2.902257
Step 3200 - mean train loss  2.902849
Step 3300 - mean train loss  2.901599
Step 3400 - mean train loss  2.895926
Step 3500 - mean train loss  2.898446
Step 3600 - mean train loss  2.897778
Step 3700 - mean train loss  2.893116
Step 3800 - mean train loss  2.895493
Step 3900 - mean train loss  2.895991
Step 4000 - mean train loss  2.899053
Step 4100 - mean train loss  2.900130
Step 4200 - mean train loss  2.898021
Step 4300 - mean train loss  2.900318
Step 4400 - mean train loss  2.901591
Step 4500 - mean train loss  2.897911
Step 4600 - mean train loss  2.899610
Step 4700 - mean train loss  2.899054
Step 4800 - mean train loss  2.899501
Step 4900 - mean train loss  2.898821
Step 5000 - mean train loss  2.897233
Step 5100 - mean train loss  2.894184
Step 5200 - mean train loss  2.893893
Step 5300 - mean train loss  2.895269
Step 5400 - mean train loss  2.895472
Step 5500 - mean train loss  2.895536
Step 5600 - mean train loss  2.893607
Step 5700 - mean train loss  2.893280
Step 5800 - mean train loss  2.892445
Step 5900 - mean train loss  2.892795
Step 6000 - mean train loss  2.891840
Step 6100 - mean train loss  2.891391
Step 6200 - mean train loss  2.892378
Step 6300 - mean train loss  2.892245
Step 6400 - mean train loss  2.892365
Step 6500 - mean train loss  2.891309
Step 6600 - mean train loss  2.893913
Step 6700 - mean train loss  2.893158
Step 6800 - mean train loss  2.892076
Step 6900 - mean train loss  2.891251
Step 7000 - mean train loss  2.891916
Step 7100 - mean train loss  2.890728
Step 7200 - mean train loss  2.890554
Step 7300 - mean train loss  2.890270
Step 7400 - mean train loss  2.890232
Step 7500 - mean train loss  2.890831
Step 7600 - mean train loss  2.889840
Step 7700 - mean train loss  2.890707
Step 7800 - mean train loss  2.890642
Step 7900 - mean train loss  2.891853
Step 8000 - mean train loss  2.892186
Step 8100 - mean train loss  2.893420
Step 8200 - mean train loss  2.891954
Step 8300 - mean train loss  2.893889
Step 8400 - mean train loss  2.893565
Step 8500 - mean train loss  2.894092
Step 8600 - mean train loss  2.893544
Step 8700 - mean train loss  2.893128
Step 8800 - mean train loss  2.893103
Step 8900 - mean train loss  2.892529
Step 9000 - mean train loss  2.891996
Step 9100 - mean train loss  2.891309
Step 9200 - mean train loss  2.890582
Step 9300 - mean train loss  2.889682
Step 9400 - mean train loss  2.890120
Step 9500 - mean train loss  2.890156
Step 9600 - mean train loss  2.889715
Step 9700 - mean train loss  2.889936
Step 9800 - mean train loss  2.889042
Step 9900 - mean train loss  2.888987
>>>>>>>>>> Training Information:
{'time/training': 3951.0405728816986,
 'training/train_loss_mean': 2.888301593244076,
 'training/train_loss_std': 0.6636683779912631}
Checkpoint saved at: artifacts/ft_plms/llama_tiny/artifacts_exp_pool_exp_pool_ss_None/peft_128_K_20_gamma_1.0_sfd_256_exec_50_stage_100_lr_0.0001_wd_0.0001_warm_2000_iters_10_steps_10000_seed_666/early_stop_-1_checkpoint/1
==================== Training Iteration #2 ====================
Step 0 - mean train loss  3.085194
Step 100 - mean train loss  2.801891
Step 200 - mean train loss  2.804096
Step 300 - mean train loss  2.816975
Step 400 - mean train loss  2.838339
Step 500 - mean train loss  2.834218
Step 600 - mean train loss  2.837649
Step 700 - mean train loss  2.845880
Step 800 - mean train loss  2.842367
Step 900 - mean train loss  2.842622
Step 1000 - mean train loss  2.838251
Step 1100 - mean train loss  2.836118
Step 1200 - mean train loss  2.842573
Step 1300 - mean train loss  2.839244
Step 1400 - mean train loss  2.839741
Step 1500 - mean train loss  2.833670
Step 1600 - mean train loss  2.839560
Step 1700 - mean train loss  2.843571
Step 1800 - mean train loss  2.848333
Step 1900 - mean train loss  2.843177
Step 2000 - mean train loss  2.840774
Step 2100 - mean train loss  2.840943
Step 2200 - mean train loss  2.836232
Step 2300 - mean train loss  2.836252
Step 2400 - mean train loss  2.840442
Step 2500 - mean train loss  2.843419
Step 2600 - mean train loss  2.842599
Step 2700 - mean train loss  2.844616
Step 2800 - mean train loss  2.850227
Step 2900 - mean train loss  2.848459
Step 3000 - mean train loss  2.849149
Step 3100 - mean train loss  2.853731
Step 3200 - mean train loss  2.854810
Step 3300 - mean train loss  2.856124
Step 3400 - mean train loss  2.854189
Step 3500 - mean train loss  2.856984
Step 3600 - mean train loss  2.854145
Step 3700 - mean train loss  2.855654
Step 3800 - mean train loss  2.854182
Step 3900 - mean train loss  2.853923
Step 4000 - mean train loss  2.856113
Step 4100 - mean train loss  2.856257
Step 4200 - mean train loss  2.853653
Step 4300 - mean train loss  2.856710
Step 4400 - mean train loss  2.857197
Step 4500 - mean train loss  2.857081
Step 4600 - mean train loss  2.856509
Step 4700 - mean train loss  2.858187
Step 4800 - mean train loss  2.858029
Step 4900 - mean train loss  2.859468
Step 5000 - mean train loss  2.857128
Step 5100 - mean train loss  2.856658
Step 5200 - mean train loss  2.855258
Step 5300 - mean train loss  2.856453
Step 5400 - mean train loss  2.858296
Step 5500 - mean train loss  2.857214
Step 5600 - mean train loss  2.858666
Step 5700 - mean train loss  2.860669
Step 5800 - mean train loss  2.860252
Step 5900 - mean train loss  2.859314
Step 6000 - mean train loss  2.860886
Step 6100 - mean train loss  2.860509
Step 6200 - mean train loss  2.862216
Step 6300 - mean train loss  2.861838
Step 6400 - mean train loss  2.860426
Step 6500 - mean train loss  2.860270
Step 6600 - mean train loss  2.860079
Step 6700 - mean train loss  2.859737
Step 6800 - mean train loss  2.859023
Step 6900 - mean train loss  2.860355
Step 7000 - mean train loss  2.861814
Step 7100 - mean train loss  2.863277
Step 7200 - mean train loss  2.862868
Step 7300 - mean train loss  2.862653
Step 7400 - mean train loss  2.863765
Step 7500 - mean train loss  2.865449
Step 7600 - mean train loss  2.863467
Step 7700 - mean train loss  2.863074
Step 7800 - mean train loss  2.863121
Step 7900 - mean train loss  2.863813
Step 8000 - mean train loss  2.863951
Step 8100 - mean train loss  2.865703
Step 8200 - mean train loss  2.866433
Step 8300 - mean train loss  2.865934
Step 8400 - mean train loss  2.866281
Step 8500 - mean train loss  2.866836
Step 8600 - mean train loss  2.865833
Step 8700 - mean train loss  2.866461
Step 8800 - mean train loss  2.866128
Step 8900 - mean train loss  2.865254
Step 9000 - mean train loss  2.866060
Step 9100 - mean train loss  2.864916
Step 9200 - mean train loss  2.864175
Step 9300 - mean train loss  2.863048
Step 9400 - mean train loss  2.864008
Step 9500 - mean train loss  2.864379
Step 9600 - mean train loss  2.864324
Step 9700 - mean train loss  2.863352
Step 9800 - mean train loss  2.864180
Step 9900 - mean train loss  2.863476
>>>>>>>>>> Training Information:
{'time/training': 3685.0342700481415,
 'training/train_loss_mean': 2.863901792830229,
 'training/train_loss_std': 0.6964322695155952}
Checkpoint saved at: artifacts/ft_plms/llama_tiny/artifacts_exp_pool_exp_pool_ss_None/peft_128_K_20_gamma_1.0_sfd_256_exec_50_stage_100_lr_0.0001_wd_0.0001_warm_2000_iters_10_steps_10000_seed_666/early_stop_-1_checkpoint/2
==================== Training Iteration #3 ====================
Step 0 - mean train loss  3.361775
Step 100 - mean train loss  2.912479
Step 200 - mean train loss  2.872963
Step 300 - mean train loss  2.857172
Step 400 - mean train loss  2.860281
Step 500 - mean train loss  2.853088
Step 600 - mean train loss  2.854346
Step 700 - mean train loss  2.845952
Step 800 - mean train loss  2.849334
Step 900 - mean train loss  2.848869
Step 1000 - mean train loss  2.851288
Step 1100 - mean train loss  2.857980
Step 1200 - mean train loss  2.848454
Step 1300 - mean train loss  2.836968
Step 1400 - mean train loss  2.835307
Step 1500 - mean train loss  2.837458
Step 1600 - mean train loss  2.837269
Step 1700 - mean train loss  2.838872
Step 1800 - mean train loss  2.837671
Step 1900 - mean train loss  2.844144
Step 2000 - mean train loss  2.849408
Step 2100 - mean train loss  2.847981
Step 2200 - mean train loss  2.848039
Step 2300 - mean train loss  2.850519
Step 2400 - mean train loss  2.846417
Step 2500 - mean train loss  2.847155
Step 2600 - mean train loss  2.853198
Step 2700 - mean train loss  2.851598
Step 2800 - mean train loss  2.846635
Step 2900 - mean train loss  2.850741
Step 3000 - mean train loss  2.845336
Step 3100 - mean train loss  2.844188
